apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: create-ovh-secret-
spec:
  serviceAccountName: devseed
  entrypoint: create-secret
  templates:
    - name: create-secret
      inputs:
        parameters:
          - name: namespace
            value: devseed
          - name: aws_access_key_id
          - name: aws_secret_access_key
      resource:
        action: apply
        manifest: |
          apiVersion: v1
          kind: Secret
          metadata:
            name: ovh-s3-creds
            namespace: {{inputs.parameters.namespace}}
          type: Opaque
          stringData:
            AWS_ACCESS_KEY_ID: {{inputs.parameters.aws_access_key_id}}
            AWS_SECRET_ACCESS_KEY: {{inputs.parameters.aws_secret_access_key}}
